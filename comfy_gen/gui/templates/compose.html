{% extends "base.html" %}
{% block title %}Compose - ComfyGen{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Intelligent Composition</h1>
    <p class="subtitle">Compose categories into generation recipes with @tags</p>
</div>

<div class="compose-page">
    <section class="input-section">
        <div class="card">
            <h2>Compose Input</h2>
            
            <div class="input-group">
                <label for="compose-input">
                    Enter @tags and/or natural language
                </label>
                <textarea 
                    id="compose-input" 
                    placeholder="@portrait @outdoor professional headshot natural lighting..."
                    rows="4"
                ></textarea>
                <div class="tag-hints" id="tag-hints">
                    <small>Use @tag syntax for explicit categories, or just describe what you want</small>
                </div>
            </div>
            
            <div class="compose-options">
                <div class="setting">
                    <label for="policy-tier">Policy Tier</label>
                    <select id="policy-tier">
                        <option value="general">General</option>
                        <option value="mature">Mature</option>
                        <option value="explicit">Explicit</option>
                    </select>
                </div>
                <div class="setting">
                    <label for="max-categories">Max Categories</label>
                    <input type="number" id="max-categories" value="3" min="1" max="10">
                </div>
                <div class="setting">
                    <label for="min-confidence">Min Confidence</label>
                    <input type="number" id="min-confidence" value="0.3" step="0.1" min="0" max="1">
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="preview-btn" class="btn secondary">Preview</button>
                <button id="compose-btn" class="btn primary">Compose & Generate</button>
            </div>
        </div>
    </section>
    
    <section class="explanation-section">
        <div class="card">
            <h2>Explanation</h2>
            
            <div id="explanation-block" class="hidden">
                <div class="explanation-summary" id="explanation-summary"></div>
                
                <div class="explanation-details">
                    <h3>Categories</h3>
                    <div class="category-pills" id="category-pills"></div>
                    
                    <h3>Composition Steps</h3>
                    <div class="steps-timeline" id="steps-timeline"></div>
                    
                    <div id="warnings-section" class="hidden">
                        <h3>Warnings</h3>
                        <ul id="warnings-list" class="warnings-list"></ul>
                    </div>
                    
                    <div id="suggestions-section" class="hidden">
                        <h3>Suggestions</h3>
                        <ul id="suggestions-list" class="suggestions-list"></ul>
                    </div>
                </div>
            </div>
            
            <div id="empty-explanation" class="empty-state">
                <p>Enter @tags or keywords to see composition explanation</p>
            </div>
        </div>
        
        <div class="card" id="recipe-card" style="display: none;">
            <h2>Recipe Preview</h2>
            <pre id="recipe-json"></pre>
        </div>
    </section>
</div>
{% endblock %}

{% block scripts %}
<script src="/gui/static/js/compose.js"></script>
{% endblock %}
